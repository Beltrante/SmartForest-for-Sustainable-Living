<template>
  <div id="window" class="tree-container">
    <img
        id="pos11"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_1_1"
        @click="doAction('1-1')"
    />
    <img
        id="pos12"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_1_2"
        @click="doAction('1-2')"
    />
    <img
        id="pos13"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_1_3"
        @click="doAction('1-3')"
    />
    <img
        id="pos14"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_1_4"
        @click="doAction('1-4')"
    />
    <img
        id="pos15"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_1_5"
        @click="doAction('1-5')"
    />
    <img
        id="pos16"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_1_6"
        @click="doAction('1-6')"
    />
    <img
        id="pos21"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_2_1"
        @click="doAction('2-1')"
    />
    <img
        id="pos22"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_2_2"
        @click="doAction('2-2')"
    />
    <img
        id="pos23"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_2_3"
        @click="doAction('2-3')"
    />
    <img
        id="pos24"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_2_4"
        @click="doAction('2-4')"
    />
    <img
        id="pos25"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_2_5"
        @click="doAction('2-5')"
    />
    <img
        id="pos26"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_2_6"
        @click="doAction('2-6')"
    />
    <img
        id="pos31"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_3_1"
        @click="doAction('3-1')"
    />
    <img
        id="pos32"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_3_2"
        @click="doAction('3-2')"
    />
    <img
        id="pos33"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_3_3"
        @click="doAction('3-3')"
    />
    <img
        id="pos34"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_3_4"
        @click="doAction('3-4')"
    />
    <img
        id="pos35"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_3_5"
        @click="doAction('3-5')"
    />
    <img
        id="pos36"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_3_6"
        @click="doAction('3-6')"
    />
    <img
        id="pos41"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_4_1"
        @click="doAction('4-1')"
    />
    <img
        id="pos42"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_4_2"
        @click="doAction('4-2')"
    />
    <img
        id="pos43"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_4_3"
        @click="doAction('4-3')"
    />
    <img
        id="pos44"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_4_4"
        @click="doAction('4-4')"
    />
    <img
        id="pos45"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_4_5"
        @click="doAction('4-5')"
    />
    <img
        id="pos46"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_4_6"
        @click="doAction('4-6')"
    />
    <img
        id="pos51"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_5_1"
        @click="doAction('5-1')"
    />
    <img
        id="pos52"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_5_2"
        @click="doAction('5-2')"
    />
    <img
        id="pos53"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_5_3"
        @click="doAction('5-3')"
    />
    <img
        id="pos54"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_5_4"
        @click="doAction('5-4')"
    />
    <img
        id="pos55"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_5_5"
        @click="doAction('5-5')"
    />
    <img
        id="pos56"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_5_6"
        @click="doAction('5-6')"
    />
    <img
        id="pos61"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_6_1"
        @click="doAction('6-1')"
    />
    <img
        id="pos62"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_6_2"
        @click="doAction('6-2')"
    />
    <img
        id="pos63"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_6_3"
        @click="doAction('6-3')"
    />
    <img
        id="pos64"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_6_4"
        @click="doAction('6-4')"
    />
    <img
        id="pos65"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_6_5"
        @click="doAction('6-5')"
    />
    <img
        id="pos66"
        src="../assets/dynamics/trees/empty.png"
        alt=""
        class="tree floating-base pos_6_6"
        @click="doAction('6-6')"
    />
  </div>
</template>

<script>

export default {
 data() {
    return {
      numOfClicks: 0,
      positions:"",
    };
  },
  methods: {
    doAction: async function (id) {
      if(this.numOfClicks<2){
        this.positions=this.positions+id+"-";
        this.numOfClicks++;
        return;
      }
      this.positions=this.positions+id;
      console.log(this.positions)
      let answer = await $fetch('/api/click', {method: 'post', body: {id: this.positions}})
      console.log(answer)
      answer.removed.forEach((tree) => {
        let posToSpawn =
          "pos" + tree._position._x.toString() + tree._position._y.toString();
        document.getElementById(posToSpawn).src =
          "/_nuxt/assets/dynamics/trees/empty.png";
      });
      answer.trees.forEach((tree) => {
        let posToSpawn =
          "pos" + tree._position._x.toString() + tree._position._y.toString();
        let levelToSpawn = "lev" + tree._level.toString();

        document.getElementById(posToSpawn).src =
          "/_nuxt/assets/dynamics/trees/" + levelToSpawn + ".png";
        // document.getElementById(posToSpawn).visibility = 'visible';
      });
      this.positions="";
      this.numOfClicks=0;
    },

    spawnTreeInARandomPos: function () {
      document.getElementById(this.randomPos()).src =
          "/_nuxt/assets/dynamics/trees/lev" + this.randomLevel() + ".png";
    },
    randomLevel: function () {
      var num = Math.floor(Math.random() * 4 + 1);
      if (Math.floor(Math.random() * 4 + 1).toString() == 4) {
        return 'empty'
      }
      return num.toString();
    },
    randomLine: function () {
      let line = Math.floor(Math.random() * 6 + 1);
      return line.toString();
    },
    randomCol: function () {
      let pos = Math.floor(Math.random() * 6 + 1);
      return pos.toString();
    },
    randomPos: function () {
      return "pos" + this.randomLine() + this.randomCol();
    },
  },
  mounted() {
    // setInterval(() => {
    //   this.spawnTreeInARandomPos();
    // }, 100000);
  },
};
</script>

<style scoped>
.tree-container {
  width: 1080px;
  height: 960px;
  position: absolute;
}

.tree {
  position: absolute;
  height: 100px;
  width: auto;
  z-index: 103;
  display: flex;
  /* filter: brightness(1.2); */
  /* visibility: hidden; */
  /* filter: drop-shadow(2px 0px 1px rgba(34, 34, 34, 0.7));*/
}

.pos_1_1 {
  bottom: 500px;
  left: 100px;
}

.pos_1_2 {
  bottom: 545px;
  left: 180px;
}

.pos_1_3 {
  bottom: 590px;
  left: 260px;
}

.pos_1_4 {
  bottom: 635px;
  left: 340px;
}

.pos_1_5 {
  bottom: 680px;
  left: 420px;
}

.pos_1_6 {
  bottom: 725px;
  left: 490px;
}

.pos_2_1 {
  bottom: 450px;
  left: 180px;
}

.pos_2_2 {
  bottom: 500px;
  left: 260px;
}

.pos_2_3 {
  bottom: 545px;
  left: 340px;
}

.pos_2_4 {
  bottom: 590px;
  left: 420px;
}

.pos_2_5 {
  bottom: 635px;
  left: 490px;
}

.pos_2_6 {
  bottom: 680px;
  left: 570px;
}

.pos_3_1 {
  bottom: 400px;
  left: 260px;
}

.pos_3_2 {
  bottom: 450px;
  left: 340px;
}

.pos_3_3 {
  bottom: 500px;
  left: 420px;
}

.pos_3_4 {
  bottom: 545px;
  left: 490px;
}

.pos_3_5 {
  bottom: 590px;
  left: 570px;
}

.pos_3_6 {
  bottom: 635px;
  left: 650px;
}

.pos_4_1 {
  bottom: 355px;
  left: 340px;
}

.pos_4_2 {
  bottom: 400px;
  left: 420px;
}

.pos_4_3 {
  bottom: 450px;
  left: 490px;
}

.pos_4_4 {
  bottom: 500px;
  left: 570px;
}

.pos_4_5 {
  bottom: 545px;
  left: 650px;
}

.pos_4_6 {
  bottom: 590px;
  left: 730px;
}

.pos_5_1 {
  bottom: 310px;
  left: 420px;
}

.pos_5_2 {
  bottom: 355px;
  left: 490px;
}

.pos_5_3 {
  bottom: 400px;
  left: 570px;
}

.pos_5_4 {
  bottom: 445px;
  left: 650px;
}

.pos_5_5 {
  bottom: 490px;
  left: 730px;
}

.pos_5_6 {
  bottom: 545px;
  left: 810px;
}

.pos_6_1 {
  bottom: 265px; /*-235px*/
  left: 490px; /*+390px */
}

.pos_6_2 {
  bottom: 310px;
  left: 570px;
}

.pos_6_3 {
  bottom: 355px;
  left: 650px;
}

.pos_6_4 {
  bottom: 400px;
  left: 730px;
}

.pos_6_5 {
  bottom: 445px;
  left: 810px;
}

.pos_6_6 {
  bottom: 490px;
  left: 890px;
}

.floating-base {
  animation-name: floating-base;
  animation-duration: 20s;
  animation-iteration-count: infinite;
  animation-timing-function: ease-in-out;
  margin-top: 5px;
}

@keyframes floating-base {
  0% {
    transform: translate(0, 0px);
  }
  50% {
    transform: translate(0, 10px);
  }
  100% {
    transform: translate(0, -0px);
  }
}
</style>
